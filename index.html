<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Names & Phone Numbers</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Search Names & Phone Numbers</h1>
    <input type="text" id="searchBox" placeholder="Search by CIF, Name, Address or Phone Number...">
    <button id="searchButton">Search</button>
    <table id="results">
        <thead>
            <tr>
                <th>CIF</th>
                <th>Name</th>
                <th>Address</th>
                <th>Phone Number</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let data = [];

            function fetchData() {
                // Fetch data from both data.json and data1.json
                Promise.all([fetch("data.json"), fetch("data1.json")])
                    .then(responses => {
                        // Check if both responses are successful
                        if (!responses[0].ok || !responses[1].ok) {
                            throw new Error("Failed to load one or both JSON files.");
                        }
                        // Parse both JSON files
                        return Promise.all([responses[0].json(), responses[1].json()]);
                    })
                    .then(jsonData => {
                        // Merge data from both files
                        data = [...jsonData[0], ...jsonData[1]];
                        console.log("Data loaded successfully");
                    })
                    .catch(error => {
                        console.error("Error loading data:", error);
                        alert("Failed to load data. Please ensure data.json and data1.json are available.");
                    });
            }

            function performSearch() {
                if (data.length === 0) {
                    alert("Data is still loading or unavailable.");
                    return;
                }
                const query = document.getElementById("searchBox").value.toLowerCase();
                const results = data.filter(item =>
                    item.CIF.toLowerCase().includes(query) ||
                    item.Name.toLowerCase().includes(query) ||
                    item.Address.toLowerCase().includes(query) ||
                    item.Phone_Number.includes(query)
                );
                displayResults(results);
            }

            function displayResults(results) {
                const resultsTable = document.querySelector("#results tbody");
                resultsTable.innerHTML = results.length > 0 ? results.map(item =>
                    `<tr>
                        <td>${item.CIF}</td>
                        <td>${item.Name}</td>
                        <td>${item.Address}</td>
                        <td>${item.Phone_Number}</td>
                    </tr>`).join("") : "<tr><td colspan='4'>No results found</td></tr>";
            }

            document.getElementById("searchButton").addEventListener("click", performSearch);

            fetchData();  // Load data on page load
        });
    </script>
</body>
</html>
